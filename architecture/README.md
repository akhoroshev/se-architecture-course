# Архитектура приложения

## Объекты и интерфейсы

* IEnvironment - хранилище для переменных контекста
* IPreprocessor - принимает строку, делает подстановки переменных из контекста, разбивает все на отдельные токены
* IParser - обрабатывает список токенов и сопоставляет им последовательность команд
* ICommand - базовый интерфейс для команд.
* IStream - базовый класс для stream'ов, каждая команда имеет input_stream и output_stream с которыми взаимодействует. 
В качетсве IStream используется  [TextIOWrapper](https://docs.python.org/3.6/library/io.html)

* CliExecutor - main loop

## Pipeline
* В CliExecutor.add_command регестрируются команды доступные для выполнения
### Main loop
* CliExecutor считывает команду из stdin
* PreprocessorImpl.process делает необходимые подстановки в команде (в соответсвии с контекстом), и разбивает команду на отдельные токены
* ParserImpl.parse разбирает массив токенов на отдельные команды, которые были в него добавлены
* CliExecutor.execute_command_list выполняет последовательность команд, передавая последовательно
 выходной стрим одной команды в качестве входного другой (pipe)